<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Subdomain Abuse Test - PHISH-006</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; background-color: #f5f5f5; }
    .test-container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    h1 { color: #16a085; border-bottom: 2px solid #16a085; padding-bottom: 10px; }
    .test-info { background: #d5f4e6; border-left: 4px solid #16a085; padding: 15px; margin: 20px 0; }
    .subdomain-demo { background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0; font-family: monospace; }
    .legit { color: #27ae60; font-weight: bold; }
    .phish { color: #e74c3c; font-weight: bold; }
    .button { background: #16a085; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; margin: 10px 5px; }
    .button:hover { background: #138d75; }
    #result { margin-top: 20px; padding: 15px; border-radius: 4px; display: none; }
    #result.visible { display: block; }
    code { background: #f8f9fa; padding: 2px 6px; border-radius: 3px; font-family: 'Courier New', monospace; }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>üî¨ Phishing Detection Test: Subdomain Abuse (PHISH-006)</h1>

    <div class="test-info">
      <strong>‚ö†Ô∏è Test Objective:</strong> Detect phishing attacks that use excessive subdomains
      to deceive users into thinking they're on a legitimate site.
    </div>

    <h2>Subdomain Abuse Technique</h2>
    <p>
      Attackers register domains like <code>phishing.com</code> and create deceptive subdomains:
    </p>

    <div class="subdomain-demo">
      <div style="margin: 10px 0;">
        <span class="legit">LOOKS LEGITIMATE:</span><br>
        <code>login.secure.account.paypal.phishing.com</code>
      </div>
      <div style="margin: 10px 0;">
        <span class="phish">ACTUAL DOMAIN:</span><br>
        <code>login.secure.account.paypal.<strong style="color: #e74c3c;">phishing.com</strong></code>
      </div>
    </div>

    <p>
      The actual domain is <code>phishing.com</code>, but users may only see
      "paypal" in the address bar and assume it's legitimate.
    </p>

    <h2>Detection Criteria</h2>
    <ul>
      <li><strong>4+ subdomains:</strong> Highly suspicious</li>
      <li><strong>Contains popular brand names:</strong> Likely phishing</li>
      <li><strong>Mixes security terms:</strong> "secure", "login", "account", "verify"</li>
    </ul>

    <h2>Test Scenarios</h2>
    <div style="margin: 30px 0;">
      <button id="test-paypal-abuse" class="button">
        Test: login.secure.account.paypal.phishing.com
      </button>
      <button id="test-bank-abuse" class="button">
        Test: verify.secure.chase.bank-login.xyz
      </button>
      <button id="test-amazon-abuse" class="button">
        Test: account.verify.amazon.secure-login.top
      </button>
    </div>

    <div id="result"></div>
  </div>

  <script>
    window.__phishingTestData = {
      testId: 'PHISH-006',
      testCases: [
        {
          url: 'login.secure.account.paypal.phishing.com',
          subdomains: ['login', 'secure', 'account', 'paypal'],
          actualDomain: 'phishing.com',
          impersonatedBrand: 'paypal',
          subdomainCount: 4
        },
        {
          url: 'verify.secure.chase.bank-login.xyz',
          subdomains: ['verify', 'secure', 'chase'],
          actualDomain: 'bank-login.xyz',
          impersonatedBrand: 'chase',
          subdomainCount: 3
        },
        {
          url: 'account.verify.amazon.secure-login.top',
          subdomains: ['account', 'verify', 'amazon'],
          actualDomain: 'secure-login.top',
          impersonatedBrand: 'amazon',
          subdomainCount: 3
        }
      ],
      expectedDetection: {
        excessiveSubdomains: true,
        phishingScore: 0.15, // Additional weight
        shouldAlert: true
      }
    };

    function testSubdomainAbuse(testCase) {
      const resultDiv = document.getElementById('result');
      resultDiv.className = 'visible';
      resultDiv.style.background = '#f8d7da';
      resultDiv.style.border = '1px solid #f5c6cb';
      resultDiv.style.color = '#721c24';

      resultDiv.innerHTML = `
        <strong>‚ö†Ô∏è Subdomain Abuse Detected!</strong>
        <br><br>
        <strong>Full URL:</strong> <code>${testCase.url}</code>
        <br>
        <strong>Subdomains:</strong> ${testCase.subdomains.join(' ‚Üí ')}
        <br>
        <strong>Actual Domain:</strong> <code style="color: #e74c3c; font-weight: bold;">${testCase.actualDomain}</code>
        <br>
        <strong>Impersonated Brand:</strong> ${testCase.impersonatedBrand}
        <br>
        <strong>Subdomain Count:</strong> ${testCase.subdomainCount}
        <br><br>
        <strong>Detection Details:</strong>
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>Excessive subdomain nesting (${testCase.subdomainCount} levels)</li>
          <li>Contains legitimate brand name in subdomain</li>
          <li>Actual domain is <strong>not</strong> ${testCase.impersonatedBrand}.com</li>
          <li>Phishing Score: <strong>+0.15</strong> (15% weight)</li>
        </ul>
        <strong>Risk:</strong> Users may mistake this for a legitimate ${testCase.impersonatedBrand} page.
        <br><br>
        <strong>Recommendation:</strong> Show clear warning about actual domain ownership.
      `;

      window.__subdomainAbuseDetected = true;
      window.__detectionResult = {
        detected: true,
        excessiveSubdomains: true,
        subdomainCount: testCase.subdomainCount,
        actualDomain: testCase.actualDomain,
        impersonatedBrand: testCase.impersonatedBrand,
        phishingScore: 0.15,
        explanation: `Excessive subdomains (${testCase.subdomainCount}) impersonating ${testCase.impersonatedBrand}`
      };
    }

    document.getElementById('test-paypal-abuse').addEventListener('click', () => {
      testSubdomainAbuse(window.__phishingTestData.testCases[0]);
    });

    document.getElementById('test-bank-abuse').addEventListener('click', () => {
      testSubdomainAbuse(window.__phishingTestData.testCases[1]);
    });

    document.getElementById('test-amazon-abuse').addEventListener('click', () => {
      testSubdomainAbuse(window.__phishingTestData.testCases[2]);
    });

    console.log('[PHISH-006] Subdomain abuse test fixture loaded');
  </script>
</body>
</html>
